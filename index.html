<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OMG Clean-up Tool</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/handsontable/dist/handsontable.full.min.css">
    <script src="https://cdn.jsdelivr.net/npm/handsontable/dist/handsontable.full.min.js"></script>
    <link rel="stylesheet" type="text/css" href="styles.css">
</head>
<body>

    <div class="container">
        <form id="csv-form">
            <div class="title2"> OMG Clean-Up</div>
            <div class="file-drop-area">
                <span class="file-msg">2. Drag & drop Order_Report.csv</span>
                <input type="file" id="csv-file" class="file-input">
            </div>
            <button type="submit">Upload</button>
        </form>
        <div id="status"></div>
        <div id="order-summary" style="display: none; background-color: green; color: white; border-radius: 12px; padding: 10px;">
            <!-- Summary will be inserted here -->
        </div>        
    </div>

    <div class="image-container">
            <div class="image-box">
                <img src="AssetURLApp/Asset 6images.jpg" alt="Descriptive Alt Text 1">
                <div class="overlay">
                    <div class="text">1. Download "Regular" Order Report</div>
                </div>
            </div>
    
        <div class="image-box">
            <img src="AssetURLApp/Asset 4images.jpg" alt="Descriptive Alt Text 2">
            <div class="overlay">
                <div class="text">3. Clean Reports will auto-download</div>
            </div>
        </div>
      
    </div>
        <div class="container2">

    <br>
    <br>
   <center> <h3>Send to Salesforce - Exclusive for LAX/ZIMA</h3></center>
    <button id="send-to-salesforce" style="display: none; background-color: rgb(0, 115, 255); color: white; padding: 10px 20px; border: none; border-radius: 12px; cursor: pointer; margin-top: 10px; transition: all 0.3s ease;">
        Testing (Please don't click this button)
    </button>
    <br><br>
    <button id="send-to-xlsxtool" background-color: rgb(0, 115, 255); color: white; padding: 10px 20px; border: none; border-radius: 12px; cursor: pointer; margin-top: 10px; transition: all 0.3s ease;" onclick="window.location.href='/suborderform'">
        Step 2. xlsx Tool
    </button>         </div>



    <div class="overlay2" id="overlay2">
        <div class="content">
            <h2>ðŸ§¼ OMG Reporting Cleanup Tool</h2>
            <p>This is a tool that will help clean up OMG Order Reports, removing unnecessary fields and returning 2 cleaned CSVs</p>
            <h3>Files Generated</h3>
          <p>1 CSV with aggregated Product totals, this will be used to input into Salesforce</p>
          <p>1 CSV with itemized Products split by Qty, Sorted by Size, Number, Last Name, this will be used for sending to the coach, and for submitting sublimation orders</p>
            <h2>How it Works</h2>
          <h3>Player Name Fields</h3>
          <p>There are 2 player name fields. 1 is to identify the Player Name at checkout, 1 is to identify if the garment has names included it. The names to be included in the garment are in all caps and located in column <b>Last Name</b>.</p>
            <h3>Size Fields</h3>
          <p>The size information is standardized. Any field that represents the size of an item is edited to match a uniform format. For example Mens 2XL, 2XLarge, and 2X-Large are converted to 2XL</p>
          <h3>Player Number Fields</h3>
          <p>These fields are checked for errors and normalized if needed. This means the system looks for and corrects any invalid or inconsistent player numbers (Letters in the number field) or names. A warning will be displayed if an error is detected. Please note this does not check spelling of the name.</p>
          <h3>Quantity Fields</h3>
          <p>In the data expansion step, quantity fields are adjusted based on quantity ordered, <br> <b>specifically cloning products with Qty 2+ into individual line items with Qty 1 for order forms</b></p>
        </div>
      </div>
      
      <div class="open-btn" onclick="toggleOverlay()">+</div>
      


<script>function toggleOverlay() {
    const overlay = document.querySelector('.overlay2');
    const openButton = document.querySelector('.open-btn'); // Select the open button
    // Toggle the right style by checking if it's currently shown
    if (overlay.style.right === '0px') {
      overlay.style.right = '120%'; // Slide out
      openButton.classList.remove('rotate'); // Revert the rotation on the open button
    } else {
      overlay.style.right = '0px'; // Slide in
      openButton.classList.add('rotate'); // Rotate the open button
    }
  }
  
  window.onclick = function(event) {
    const overlay = document.getElementById('overlay2');
    if (event.target === overlay) {
      toggleOverlay(); // Call toggleOverlay without parameters
    }
  }
  

</script>

<style>
    .rotate {
    transform: rotate(45deg) !important; /* Rotates the element by 45 degrees */
    transition: transform 0.3s ease-in-out; /* Smooth transition for rotation */
}
</style>



    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>
    <script src="app.js"></script>
</body>
</html>
